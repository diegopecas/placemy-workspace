<!-- apps/fronthouse/src/app/features/dashboard/pages/dashboard/dashboard.component.html -->
<div class="dashboard-container" [attr.data-theme]="currentTheme().name">
  <!-- Header / Toolbar -->
  <app-header></app-header>

  <!-- Part铆culas flotantes tem谩ticas -->
  <app-floating-particles [particleCount]="20"></app-floating-particles>
  <!-- Contenido principal -->
  <div class="dashboard-content">
    <!-- Header de bienvenida -->
    <div class="welcome-section fade-in-up">
      <h2>Bienvenido, {{ getUserDisplayName() }}</h2>
      <p>Selecciona una opci贸n para comenzar a gestionar <strong>{{ getEstablecimientoName() }}</strong></p>
      <p class="theme-indicator"> Tema activo: {{ currentTheme().title }}</p>
    </div>

    <!-- Loading spinner -->
    @if (isLoading()) {
    <div class="loading-container">
      <mat-spinner diameter="60"></mat-spinner>
    </div>
    }

    <!-- Grid de tarjetas del men煤 principal (filtradas por permisos) -->
    @if (menuCards().length > 0) {
      <div class="menu-grid">
        @for (card of menuCards(); track card.title) {
        <mat-card
          class="menu-card fade-in-up"
          (click)="navigateTo(card.route)"
          [class]="'card-' + card.color"
          appButtonBurst
        >
          <div
            class="card-header"
            [style.background]="
              'linear-gradient(135deg, ' +
              card.colorLight +
              ', ' +
              card.colorDark +
              ')'
            "
          >
            <mat-icon class="card-icon">{{ card.icon }}</mat-icon>
          </div>

          <mat-card-content>
            <h3>{{ card.title }}</h3>
            <p>{{ card.description }}</p>

            <div class="card-stats">
              <span class="stats-label">{{ card.stats.label }}</span>
              <span class="stats-value">{{ card.stats.value }}</span>
            </div>
          </mat-card-content>

          <div class="card-overlay"></div>
        </mat-card>
        }
      </div>
    } @else {
      <!-- Mensaje cuando no hay opciones disponibles -->
      <div class="no-permissions-message">
        <mat-icon class="warning-icon">lock</mat-icon>
        <h3>No tienes acceso a ning煤n m贸dulo</h3>
        <p>Contacta al administrador para que te asigne los permisos necesarios en <strong>{{ getEstablecimientoName() }}</strong>.</p>
      </div>
    }

    <!-- Panel de informaci贸n adicional -->
    <div class="info-grid">
      <!-- Informaci贸n del sistema -->
      <mat-card class="info-card">
        <mat-card-header>
          <mat-icon mat-card-avatar class="info-icon system-icon"
            >info</mat-icon
          >
          <mat-card-title>Informaci贸n del Sistema</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="info-item">
            <span class="label">Versi贸n</span>
            <span class="value">{{ appInfo.version }}</span>
          </div>
          <mat-divider></mat-divider>
          <div class="info-item">
            <span class="label">Estado</span>
            <mat-chip class="status-chip active">Activo</mat-chip>
          </div>
          <mat-divider></mat-divider>
          <div class="info-item">
            <span class="label">ltima actualizaci贸n</span>
            <span class="value">Hoy</span>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Informaci贸n del usuario -->
      <mat-card class="info-card">
        <mat-card-header>
          <mat-icon mat-card-avatar class="info-icon user-icon"
            >person</mat-icon
          >
          <mat-card-title>Mi Perfil</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          @if (currentUser()) {
          <div class="info-item">
            <span class="label">Usuario</span>
            <span class="value">{{ currentUser()?.username }}</span>
          </div>
          <mat-divider></mat-divider>
          <div class="info-item">
            <span class="label">Email</span>
            <span class="value">{{ currentUser()?.email }}</span>
          </div>
          <mat-divider></mat-divider>
          <div class="info-item">
            <span class="label">Rol</span>
            <mat-chip class="role-chip">{{ getUserRole() }}</mat-chip>
          </div>
          <mat-divider></mat-divider>
          <div class="info-item">
            <span class="label">Establecimiento</span>
            <span class="value">{{ getEstablecimientoName() }}</span>
          </div>
          } @else {
          <div class="loading-message">
            <mat-spinner diameter="30"></mat-spinner>
            <p>Cargando informaci贸n del usuario...</p>
          </div>
          }
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Footer -->
    <footer class="dashboard-footer">
      <p>
        漏 {{ appInfo.year }} {{ appInfo.name }}. Todos los derechos reservados.
      </p>
    </footer>
  </div>
</div>
