<!-- apps/fronthouse/src/app/features/dashboard/pages/dashboard/dashboard.component.html -->
<div class="dashboard-container" [attr.data-theme]="currentTheme().name">
  <!-- Header / Toolbar -->
  <app-header></app-header>

  <!-- ‚ú® Part√≠culas flotantes tem√°ticas ‚ú® -->
  <div class="floating-particles">
    <div *ngFor="let p of floatingParticles()" 
         class="theme-particle"
         [style.left.%]="p.x"
         [style.top.%]="p.y"
         [style.animation-delay.s]="p.delay"
         [style.animation-duration.s]="p.duration">
      {{ p.icon }}
    </div>
  </div>

  <!-- ‚ú® Estrellas de fondo ‚ú® -->
  <div class="stars-background">
    <div *ngFor="let star of stars" 
         class="star" 
         [style.top.%]="star.top" 
         [style.left.%]="star.left"
         [style.width.px]="star.size" 
         [style.height.px]="star.size"
         [style.animation-duration.s]="star.duration">
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="dashboard-content">
    <!-- Header de bienvenida -->
    <div class="welcome-section fade-in-up">
      <h2>Bienvenido, {{ getUserDisplayName() }}</h2>
      <p>Selecciona una opci√≥n para comenzar a gestionar tu restaurante</p>
      <p class="theme-indicator">üé® Tema activo: {{ currentTheme().title }}</p>
    </div>

    <!-- Loading spinner -->
    @if (isLoading()) {
    <div class="loading-container">
      <mat-spinner diameter="60"></mat-spinner>
    </div>
    }

    <!-- Grid de tarjetas del men√∫ principal (filtradas por permisos) -->
    @if (menuCards().length > 0) {
      <div class="menu-grid">
        @for (card of menuCards(); track card.title) {
        <mat-card
          class="menu-card fade-in-up"
          (click)="navigateTo(card.route)"
          [class]="'card-' + card.color"
          appButtonBurst
        >
          <div
            class="card-header"
            [style.background]="
              'linear-gradient(135deg, ' +
              card.colorLight +
              ', ' +
              card.colorDark +
              ')'
            "
          >
            <mat-icon class="card-icon">{{ card.icon }}</mat-icon>
          </div>

          <mat-card-content>
            <h3>{{ card.title }}</h3>
            <p>{{ card.description }}</p>

            <div class="card-stats">
              <span class="stats-label">{{ card.stats.label }}</span>
              <span class="stats-value">{{ card.stats.value }}</span>
            </div>
          </mat-card-content>

          <div class="card-overlay"></div>
        </mat-card>
        }
      </div>
    } @else {
      <!-- Mensaje cuando no hay opciones disponibles -->
      <div class="no-permissions-message">
        <mat-icon class="warning-icon">lock</mat-icon>
        <h3>No tienes acceso a ning√∫n m√≥dulo</h3>
        <p>Contacta al administrador para que te asigne los permisos necesarios.</p>
      </div>
    }

    <!-- Panel de informaci√≥n adicional -->
    <div class="info-grid">
      <!-- Informaci√≥n del sistema -->
      <mat-card class="info-card">
        <mat-card-header>
          <mat-icon mat-card-avatar class="info-icon system-icon"
            >info</mat-icon
          >
          <mat-card-title>Informaci√≥n del Sistema</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="info-item">
            <span class="label">Versi√≥n</span>
            <span class="value">{{ appInfo.version }}</span>
          </div>
          <mat-divider></mat-divider>
          <div class="info-item">
            <span class="label">Estado</span>
            <mat-chip class="status-chip active">Activo</mat-chip>
          </div>
          <mat-divider></mat-divider>
          <div class="info-item">
            <span class="label">√öltima actualizaci√≥n</span>
            <span class="value">Hoy</span>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Informaci√≥n del usuario -->
      <mat-card class="info-card">
        <mat-card-header>
          <mat-icon mat-card-avatar class="info-icon user-icon"
            >person</mat-icon
          >
          <mat-card-title>Mi Perfil</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          @if (currentUser()) {
          <div class="info-item">
            <span class="label">Usuario</span>
            <span class="value">{{ currentUser()?.username }}</span>
          </div>
          <mat-divider></mat-divider>
          <div class="info-item">
            <span class="label">Email</span>
            <span class="value">{{ currentUser()?.email }}</span>
          </div>
          <mat-divider></mat-divider>
          <div class="info-item">
            <span class="label">Rol</span>
            <mat-chip class="role-chip">{{ getUserRole() }}</mat-chip>
          </div>
          } @else {
          <div class="loading-message">
            <mat-spinner diameter="30"></mat-spinner>
            <p>Cargando informaci√≥n del usuario...</p>
          </div>
          }
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Footer -->
    <footer class="dashboard-footer">
      <p>
        ¬© {{ appInfo.year }} {{ appInfo.name }}. Todos los derechos reservados.
      </p>
    </footer>
  </div>
</div>
